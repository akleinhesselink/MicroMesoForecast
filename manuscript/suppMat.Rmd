---
layout: 12pt
header-includes:
   - \usepackage{lineno}
   - \linenumbers
   - \usepackage{setspace}
   - \doublespacing
bibliography: ~/Dropbox/Bibliography/MicroMeso.bib
csl: components/ecology.csl

## rmarkdown render options
output:
  pdf_document:
    fig_caption: true
    keep_tex: true
fontsize: 12pt
geometry: margin=1in

---

Supplementary Information: Do we need detailed demographic data to forecast population responses to climate change?
========================================================================================

### Andrew T. Tredennick and Peter B. Adler

*Andrew T. Tredennick ([atredenn@gmail.com](mailto:atredenn@gmail.com)), Department of Wildland Resources and the Ecology Center, Utah State University, Logan, UT*

*Peter B. Adler, Department of Wildland Resources and the Ecology Center, Utah State University, Logan, UT*

```{r caching, include=FALSE}
library("methods")
library("knitr")
library(ggplot2)
library(reshape2)
library(plyr)
library(gridExtra)
basename <- "manuscript"
opts_chunk$set(fig.path = paste("components/figure/", basename, "-", sep=""),
               cache.path = paste("components/cache/", basename, "/", sep=""))
opts_chunk$set(cache = 2)
opts_chunk$set(tidy=FALSE, warning=FALSE, message=FALSE, 
               comment = NA, verbose = TRUE, echo=FALSE)

# PDF-based figures
opts_chunk$set(dev='pdf')
```


```{r plot-options, message=FALSE, warning=FALSE, include=FALSE, echo=FALSE}
cbPalette <- c("#000000", "#E69F00", "#56B4E9", "#009E73", 
               "#F0E442", "#0072B2", "#D55E00", "#CC79A7")

opts_chunk$set(dev='pdf', dev.args=c(version="1.3"))

```


```{r figure_S1, dependson="plot-options", fig.cap="Posterior means (vertical ticks), 75% credible intervals (heavy lines), and 95% credible intervals (light lines) of climate effects on growth at both levels of inferences. The dashed vertical line is at 0, indicating no effect.", fig.width=8, fig.height=7, cache=FALSE, results='hide'}
qbm_quants <- read.csv("../montana/quadBM/vitalRateRegressions/truncNormModel/growthQuants_withLagPpt.csv")
qbm_quants <- qbm_quants[137:160,]
qbm_quants <- qbm_quants[-c(13:16),]
coefNames <- c("ppt1", "ppt2", "lagppt", "temp1", "temp2")
qbm_quants$X <- rep(coefNames, each=4)
gQ <- ggplot(qbm_quants, aes(x=species, y=X50., group=species), color="grey25")+
  geom_hline(aes(yintercept=0), linetype="dashed")+
  geom_errorbar(aes(ymin=X2.5., ymax=X97.5.), width=0, position=position_dodge(width=0.5))+
  geom_errorbar(aes(ymin=X25., ymax=X75.), width=0, size=1.25, position=position_dodge(width=0.5))+
  geom_point(size=4, position=position_dodge(width=0.5), shape="|")+
  ylab("Standardized Coefficient Value")+
  xlab("Species")+
  facet_grid(X~.)+
  coord_flip()+
  theme_bw()+
  guides(color=guide_legend(title=""))+
  theme(legend.position="top")+
  ggtitle("Quadrat level")

gIC <- read.csv("../montana/ipm/vitalRateRegs/growth/growthQuants.csv")
gIC <- gIC[141:156,]
coefNames <- c("ppt1", "ppt2", "temp1", "temp2")
gIC$X <- rep(coefNames, each=4)
gIC$rate <- "growth"
sIC <- read.csv("../montana/ipm/vitalRateRegs/survival/survivalQuants.csv")
sIC <- sIC[141:156,]
coefNames <- c("ppt1", "ppt2", "temp1", "temp2")
sIC$X <- rep(coefNames, each=4)
sIC$rate <- "survival"
rIC <- read.csv("../montana/ipm/vitalRateRegs/recruitment/recruitmentQuants.csv")
rIC <- rIC[85:100,]
coefNames <- c("ppt1", "ppt2", "temp1", "temp2")
rIC$X <- rep(coefNames, each=4)
rIC$rate <- "colonization"
plotIC <- rbind(gIC,sIC,rIC)
gI <- ggplot(plotIC, aes(x=species, y=X50., color=rate))+
  geom_hline(aes(yintercept=0), linetype="dashed")+
  geom_errorbar(aes(ymin=X2.5., ymax=X97.5.), width=0, position=position_dodge(width=0.5))+
  geom_errorbar(aes(ymin=X25., ymax=X75.), width=0, size=1.25, position=position_dodge(width=0.5))+
  geom_point(size=4, position=position_dodge(width=0.5), shape="|")+
  ylab("Standardized Coefficient Value")+
  xlab("Species")+
  facet_grid(X ~ .)+
  coord_flip()+
  theme_bw()+
  scale_color_manual(values=c("grey25", "steelblue", "slateblue"),
                     labels=c("recruitment", "growth", "survival"))+
#   guides(color=FALSE)+
  guides(color=guide_legend(title=""))+
  theme(legend.position="top")+
  ggtitle("Individual level")

####
#### Print figure
####
gF2 <- grid.arrange(gQ, gI, ncol=2, nrow=1)
```





\documentclass[12pt]{article}
\usepackage{graphics}
\usepackage{graphicx, verbatim}
\usepackage{amssymb,amsmath}
\usepackage{tabularx}
% \usepackage[T1]{fontenc}
% \usepackage[utf8]{inputenc}
\usepackage{authblk}
\textwidth=6.2in
\textheight=8.5in
%\parskip=.3cm
\oddsidemargin=.1in
\evensidemargin=.1in
\headheight=-.3in
\usepackage{lineno}
\linenumbers
\modulolinenumbers[2]
\usepackage{setspace}
\doublespacing

\usepackage{Sweave}
\begin{document}
\input{ms_MicroMeso-concordance}


%To put figures in subfolder
%\SweaveOpts{prefix.string=figures/fig}
\DefineVerbatimEnvironment{Sinput}{Verbatim} {xleftmargin=2em}
\DefineVerbatimEnvironment{Soutput}{Verbatim}{xleftmargin=2em}
\DefineVerbatimEnvironment{Scode}{Verbatim}{xleftmargin=2em}

\title{\LARGE Micro- versus meso-scale population models for ecological forecasting under climate change}
\author[]{\large Andrew T. Tredennick\footnote{\emph{email:} atredenn@gmail.com}}
\author[]{\large Peter B. Adler}
\affil[]{\footnotesize{\emph{Department of Wildland Resources and the Ecology Center, Utah State University}}}
\maketitle

\begin{abstract}
\noindent Forecasts of populations under future climate change are constrained by the spatial and temporal scales at which we can gather data. For plants, ecologists often require individual level data to build population models; data that is difficult and expensive to collect at spatial scales greater than one square meter. Models built using such data are difficult to scale-up to spatial scales relevant to land management decisions and policy intervention. A possible route forward are density-structured models based on coarse-scale census data, which are much easier to collect over large spatial extents. However, to use coarse-scale data in a climate change context requires the assumption that the climate signals in population dynamics identified using individual-level data can also be identified when individual-level data are averaged over. Here we use a longterm dataset to model population dynamics using individual-level and plot-level data.   
\end{abstract}

\noindent{}\textbf{Keywords:} population model, forecasting, integral projection model, etc.

\section{Introduction}
Producing skillfull forecasts at spatial scales relevant to global environmental changes that play out at the landscape and regional scale has proven challenging for population ecologists. The major hurdle is that most population models, at least for plant species, are built using data from small, localized plots because parameterizing vital rate regressions requires tracking the fates of individuals. These models are difficult to scale up from the micro to meso-scales because the fitted parameters do not fully represent the spatial variation present at spatial scales beyond that at which the data are collected. 

Recently, Freckelton et al., building on work by Hastings and NAME, have proposed density-structured population models that focus on the transition of populations among discrete states, rather than the traditional approach of modeling the transitions of individuals. Such an approach could be extremely valuable because the data needed to parameterize density-structured population models is much easier, and less costly, to collect (Queenborough et al. year). For example, using a density-structured approach, one could build a population model using a time series of annual plot-based censuses of species percent cover. However, a major assumption of the density-structured approach is that the aggregate dynamics of the population observed at coarse spatial resolution faithfully represent, and correspond to, the fates of individual plants. In other words, using a density-structured approach requires a leap of faith that important covariates (e.g., climate variables) at the level of the individual are captured adequately at the population level. If we seek to forecast the impacts of climate change on plant populations, then clearly this assumption requires testing.

\section{Materials and Methods}
\subsection{Study site and data}
Our demographic data comes from the Fort Keogh Livestock and Range Research Laboratory in eastern Montana's northern mixed prairie near Miles City, Montana, USA (46 deg. 19' N, 105 deg 48' W). The dataset is freely available on Ecological Archives (CITE), and interested readers should refer to the metadata therin for a complete description. The site is about 800 m above sea level and mean annual precipitation (1878-2009) is 334 mm, with most annual precipitaion falling from April through September (76). The site is grass dominated and, for the purposes of our study, we focus on the four most abundant graminoid species: \emph{Bouteloua gracilis}, \emph{Hesperostipa comata}, \emph{Pascopyrum smithii}, and \emph{Poa secunda}. 

From 1932 to 1945 individual plants were identified and mapped annualy in 44 1-m2 quadrats using a pantograph. The quadrats were distributed in six pastures, each assigned a grazing treatment of light (1.24 ha/animal unit month), moderate (0.92 ha/aum), and heavy (0.76 ha/aum) stocking rates (two pastures per treatment). In this analysis we account for potential differences among the grazing treatments, but do not focus on grazing$\times$climate interactions. The annual maps of the quadrats were digitized and the fates of individual plants tracked and extracted using a computer program. Daily climate data, which we aggregated into climate variables of interest, are available for the duration of the data collection period (1932 - 1945) from the Miles City airport, Wiley Field, 9 km from the study site.

\subsection{Stastical models of vital rates}
The first step in building our single-species population models was to fit statistical models of vital rates at both levels of inference: individual-level and quadrat-level. Here we describe the general statistical approach at the individual-level, but the same approach applies at the quadrat-level. We modeled survival and growth as functions of genet size (quadrat cover in the quadrat-level models) and climate covariates (described in more detail below). We maintained a consistent random effects structure for both models that included three terms: (1) a random year effect on the intercept, (2) a random year effect on the coefficient for plant cover (either individual or quadrate level), and (3) a random effect of group (see Data set description) on the intercept. Vital rates for each species are modeled separately.

We used logistic regression to model survival probability:

\begin{equation}
logit(s) = \beta_{0,t} + \beta_{s,t}x + \beta_{Q} + \beta_{c,1}\theta_{1,t}\\
+ \cdots +  \beta_{c,i}\theta_{i,t} + \varepsilon_{t}
\end{equation}

\noindent where $x$ is the log of genet size (or log of quadrat areal cover), $\beta_{0,t}$ is a year-specific intercept, $\beta_{s,t}$ is the year-specific slope parameter for size, $\beta_{Q}$ is the random effect of quadrat group location, $\theta$ is a matrix of $i$ climate effects over $t$ years, $\beta_{c,i}$ is the fixed parameter for the effect of the $i$th climate covariate, and $\varepsilon_{t}$ is the error term. 

We modeled growth as gaussian process describing genet size (or quadrat cover) at time $t+1$ as a function of size at $t$ and climate covariates:

\begin{equation}
x_{t+1} = \beta_{0,t} + \beta_{s,t}x_{t} + \beta_{Q} + \beta_{c,1}\theta_{1,t}\\
+ \cdots +  \beta_{c,i}\theta_{i,t} + \varepsilon_{t}
\end{equation}

\noindent where $x$ is genet size and all other paramters are as described for the survival regression. For the quadrat-level approach we modeled growth as a process describing proportional cover within a quadrat at time $t+1$ as a function of proportional cover at time $t$ and climate covariates. Thus, instead of a gaussian process, with a normal likelihood, we modeled growth at the quadrat level as above but with a beta likelihood and a logit link to the linear predictors.  

While our approach for modeling survival and growth is similar at the individual and quadrat levels, the addition of new genets at the inidividual level or occupied sites at the quadrat level requires two separate approaches.

\subsection{Selecting climate covariates}
For both the individual-level IPM (IPM) and the quadrat-based IBM (QBM) we followed the same model selection approach for including climate covariates in vital rate regressions.  Working within the random effects structure described previously, we fit a set of models with all possible combinations of four climate covariates: fall through spring precipitation at \emph{t}-1 and \emph{t}-2 (ppt1 and ppt2, respectively) and mean spring temperature at \emph{t}-1 and \emph{t}-2 (TmeanSpr1 and TmeanSpr2, respectively), where \emph{t} is the observation year. The combinations of climate covariates we fit included same-year interactions between precipitation and temperature (e.g., a ppt1$\times$TmeanSpr1 interaction). Finally, we also fit a model with no climate covariates included as fixed effects. In total, this resulted in a set of 25 candidate models. 

We based model selection on the Deviance Information Criteria (DIC). However, for many species there were several models with $\Delta$DIC < 4, indicating that each model received generally the same amount of support. Given this ambiguity, we opted to simply select the candidate model with lowest DIC, regardless of the statistical nearness of other models, as the final model to use for simulating the population dynamics. In some cases this resulted in selecting a model with no climate covariates. We had to choose a single statistical model for each vital rate for our population models, but when comparing climate covariate selection between the individual and quadrat levels we acknowledge climate covariates selected in all models with $\Delta$DIC < 4.

\subsection{Computing}
\subsubsection{Model fitting}
All of our analyses (model selection, fitting, and simulating) were conducted in R. We used the analytical Bayesian software INLA to fit candidate vital rate models at the individual and quadrat levels for computational efficiency. This is the case except for the recruitment model at the individual level which required a more complex hierarchical approach. In that case we used the MCMC sampler in JAGS to estimate the posterior distributions of model parameters. After model selection, we used MCMC samplers, again in JAGS, to estimate the posterior distributions of model parameters for all vital rate models at the individual and quadrat levels. We obtained posterior distributions for all model parameters from three parallel MCMC chains run for 20,000 iterations, after discarding the initial 10,000 iterations. We assessed convergence visually and using the Gelman diagnostic in the R package `coda.' Scale reduction factors for all parameters were less than 1.02, indicating convergence. For the purposes of introducing stochasticity in our population models, we saved the final 1,000 iterations from each chain for all parameters to be used as randomly drawn values during population simulation.

\subsubsection{Population models}
With the posterior distribution of the vital rate statistical models in hand, it is straightforward to simulate the population models.

\section{Results}
We assessed the statistical importance of the climate covariates included the final vital rate regressions by comparing the residual deviance of models with climate covariates and temporal random effects, climate covariates only, and temporal random effects only. When a model includes climate covariates, this comparison shows the relative contribution of the climate covariates in explaining the total interannual variability (Adler et al. 2012). 

% latex table generated in R 3.1.1 by xtable 1.7-3 package
% Tue Nov 18 09:15:14 2014
\begin{table}[ht]
\centering
\caption{The proportion of interannual variability in  vital rates explained by the climate covariates. The contribution for growth is defined as: (Climate model - Constant Model)/(Full model - Constant model). The contribution for survival and colonization, where we could not estimate a full model with year random effects, is defined as: (Constant Model - Climate Model)/Constant Model. The values are model deviance estimated from the `coda' package in R.} 
\begin{tabularx}{\textwidth}{llllX}
  \hline
Vital Rate & Constant model & Climate model & Full model & Contribution of climate covariates \\ 
  \hline
Growth & -5566.24 & -5735.32 & -6167.98 & 0.28 \\ 
  Survival & 171.55 & 170.37 &  & 0.01 \\ 
  Colonization & 203.98 & 193.65 &  & 0.05 \\ 
   \hline
\end{tabularx}
\end{table}
% # <<echo=FALSE, fig=TRUE,height=3,width=8.5 >>=
% # library(ggplot2)
% # plotD <- data.frame(Species = rep(growthSSRTable$Species, 3),
% #                     Model = rep(c("Growth", "Survival", "Colonization"), each=4),
% #                     Contribution = c(growthSSRTable[,6],
% #                                      survivalSSRTable[,6],
% #                                      colonizationSSRTable[,6]))
% # ggplot(plotD, aes(x=Species, y=Contribution))+
% #   geom_bar(stat="identity")+
% #   facet_grid(.~Model)
% # @



\end{document}

---
layout: 12pt
header-includes:
   - \usepackage{lineno}
   - \linenumbers
   - \usepackage{setspace}
bibliography: ~/Dropbox/Bibliography/MicroMeso.bib
csl: components/ecology.csl

## rmarkdown render options
output:
  pdf_document:
    fig_caption: true
    keep_tex: true
fontsize: 12pt
geometry: margin=1in

---

```{r lib_reqs, echo=FALSE, message=FALSE, warning=FALSE}
library(xtable)
library(plyr)
library(reshape2)
```

```{r agg_fxn, echo=FALSE, message=FALSE, warning=FALSE}
agg_fxn <- function(mcmc_frame){
  out <- ddply(mcmc_frame, .(Parameter), summarise,
               mean_value = mean(value),
               sd_value = sd(value),
               lo_BCI = quantile(value, 0.025),
               up_BCI = quantile(value, 0.975))
  return(out)
}
spp_list <- c("BOGR", "HECO", "PASM", "POSE")
spp_name <- c("B. gracilis.", "H. comata.", "P. smithii.", "P. secunda.")
```

Appendix B: Statistical results for model fits
===============================================
Here we provide parameter estimates (mean, standard deviations, upper and lower 95% Bayesian credible intervals) from each vital rate model for the integral projection model and for the quadrat based model. We provide parameter-to-notation keys below for clarity. 

Parameter to model notation keys
--------------------------------

Table:  Definition of parameters and model notation for IPM survival and growth models.

| Parameter | Definition | Notation in statistical results tables |
| --------- | ---------- | -------------------------------------- |
| $\gamma_{t}$ | intercept for year *t* | ``a[t]`` where ``t`` is the numeric year |
| $\tilde{\gamma}$ | global intercept | ``a_mu`` |
| $\phi_{Q}$ | random effect of quadrat group *Q* | ``gint[Q]`` where ``Q`` is the quadrat group |
| $\beta_{t}$ | size effect for year *t* | ``b1[t]`` where ``t`` is the numeric year |
| $\tilde{\beta}$ | global size effect | ``b1_mu`` |
| $\gamma$ | effect of crowding | ``w[1]`` |
| $\nu$ | crowding $\times$ size effect | ``w[2]`` |
| $\theta_{k}$ | effect of climate covariate *k* | ``b2[k]`` where ``k`` is the climate effect |
| *a* | first parameter for growth variance | ``tau`` |
| *b* | second parameter for growth variance | ``tauSize`` |

Table:  Definition of parameters and model notation for IPM recruitment model.

| Parameter | Definition | Notation in statistical results tables |
| --------- | ---------- | -------------------------------------- |
| $\gamma_{t}$ | intercept for year *t* | ``a[t]`` where ``t`` is the numeric year |
| $\tilde{\gamma}$ | global intercept | ``a_mu`` |
| $\phi_{Q}$ | random effect of quadrat group *Q* | ``gint[Q]`` where ``Q`` is the quadrat group |
| $\gamma$ | effect of plot cover | ``dd`` |
| $\theta_{k}$ | effect of climate covariate *k* | ``b2[k]`` where ``k`` is the climate effect |
| *p* | mixing fraction for effective plot cover | ``u`` |
| $\zeta$ | size parameter for negative binimial likelihood | ``theta`` |

Table:  Definition of parameters and model notation for quadrat based model.

| Parameter | Definition | Notation in statistical results tables |
| --------- | ---------- | -------------------------------------- |
| $\gamma_{t}$ | intercept for year *t* | ``a[t]`` where ``t`` is the numeric year |
| $\tilde{\gamma}$ | global intercept | ``a_mu`` |
| $\phi_{Q}$ | random effect of quadrat group *Q* | ``gint[Q]`` where ``Q`` is the quadrat group |
| $\beta_{t}$ | cover effect for year *t* | ``b1[t]`` where ``t`` is the numeric year |
| $\tilde{\beta}$ | global cover effect | ``b1_mu`` |
| $\theta_{k}$ | effect of climate covariate *k* | ``b2[k]`` where ``k`` is the climate effect |
| $\tau$ | model variance in log normal likelihood | ``tau`` |

Table: Climate effect key.

| Integer ID (*k*) | Climate covariate |
| ---------------- | ----------------- |
| 1 | pptLag |
| 2 | ppt1 |
| 3 | ppt2 |
| 4 | TmeanSpr1 |
| 5 | TmeanSpr2 |
| 6 | ppt1 $\times$ TmeanSpr1 |
| 7 | ppt2 $\times$ TmeanSpr2 |
| 8 | pptLag $\times$ size |
| 9 | ppt1 $\times$ size |
| 10 | ppt2 $\times$ size |
| 11 | TmeanSpr1 $\times$ size |
| 12 | TmeanSpr2 $\times$ size |

Results from statistical models
-------------------------------
In all tables, "mean_value" is the mean parameter estimate, "sd_value" is the standard deviation of the estimate from the MCMC, "lo_BCI" is the lower limit of the 95% Bayesian Credible Interval, and "up_BCI" is the upper limit of the 95% Bayesian Credible Interval

```{r surv_params, echo=FALSE, results='asis', message=FALSE, warning=FALSE, comment=NA}
for(i in 1:length(spp_list)){
  file <- paste("../analysis/ipm/vitalRateRegs/survival/survival_stanmcmc_",
              spp_list[i], ".RDS",
              sep="")
  survmcmc <- readRDS(file)
  aggsurv <- agg_fxn(survmcmc)
  cap <- paste("Statistical results from IPM survival model for", spp_name[i])
  print(xtable(aggsurv, caption = cap), comment=FALSE, include.rownames=FALSE, 
        size="\\footnotesize", caption.placement = "top")
}
```

```{r growth_params, echo=FALSE, results='asis', message=FALSE, warning=FALSE, comment=NA}
for(i in 1:length(spp_list)){
  file <- paste("../analysis/ipm/vitalRateRegs/growth/growth_stanmcmc_",
              spp_list[i], ".RDS",
              sep="")
  survmcmc <- readRDS(file)
  aggsurv <- agg_fxn(survmcmc)
  cap <- paste("Statistical results from IPM growth model for", spp_name[i])
  print(xtable(aggsurv, caption = cap), comment=FALSE, include.rownames=FALSE, 
        size="\\footnotesize", caption.placement = "top")
}
```

```{r rec_params, echo=FALSE, results='asis', message=FALSE, warning=FALSE, comment=NA}
for(i in 1:length(spp_list)){
  file <- paste("../analysis/ipm/vitalRateRegs/recruitment/recruitment_stanmcmc_",
              spp_list[i], ".RDS",
              sep="")
  survmcmc <- readRDS(file)
  aggsurv <- agg_fxn(survmcmc)
  cap <- paste("Statistical results from IPM recruitment model for", spp_name[i])
  print(xtable(aggsurv, caption = cap), comment=FALSE, include.rownames=FALSE, 
        size="\\footnotesize", caption.placement = "top")
}
```

```{r qbm_params, echo=FALSE, results='asis', message=FALSE, warning=FALSE, comment=NA}
for(i in 1:length(spp_list)){
  file <- paste("../analysis/quadBM/vitalRateRegressions/truncNormModel/popgrowth_stanmcmc_",
              spp_list[i], ".RDS",
              sep="")
  survmcmc <- readRDS(file)
  aggsurv <- agg_fxn(survmcmc)
  cap <- paste("Statistical results from QBM population model for", spp_name[i])
  print(xtable(aggsurv, caption = cap), comment=FALSE, include.rownames=FALSE, 
        size="\\footnotesize", caption.placement = "top")
}
```